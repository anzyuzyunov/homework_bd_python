Приветствую! Connection преднамеренно обернут все функции таким образом, а не локально в каждой для удобства чтения и выполнения задания